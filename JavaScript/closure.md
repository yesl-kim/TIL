# 클로저

## 클로저의 정의

- 어떤 함수(a)의 지역변수(자유변수)를 참조하는 내부함수(b)가 외부(c, a보다 외부)로 전달될 경우, 함수(a)의 실행 컨텍스트가 종료된 이후에도 해당 변수(내부함수가 참조하는 외부 지역변수)가 메모리 상에서 사라지지 않는 현상  
  -> 실행 컨텍스트가 종료된 이후에도 외부에서 a함수의 지역변수에 접근할 수 있음

- 내부함수를 외부로 전달하는 방법으로는,

  1. 내부함수를 반환 (return _function_)
  2. 콜백함수로 전달  
     하는 방법이 있다.

- **가비지 컬렉팅**  
  자신을 참조하고 있는 식별자의 수를 참조 카운트  
  참조 카운트가 0이 되면 메모리 상에서 삭제된다. 이를 가비지 컬렉팅이라고 한다.

- 원래 함수는 실행을 종료하면 메모리 상에서 삭제되지만,  
  내부함수를 외부로 전달할 경우, 내부함수를 외부에서 다시 참조하게 되고, GC에서 제외된다.  
  같은 이유로 내부함수에서 참조하고 있는 외부 지역변수 또한 여전히 메모리 상에 남아있게 된다.

- **메모리 누수 관리**  
  다르게 말하면 결국 해당 값은 메모리를 계속 차지하고 있는 것이기 때문에, 클로저에 대해서는 어느 시점에 참조를 끊음으로 메모리 누수 관리를 해주어야 한다.

```js
var outer = (function () {
  var a = 0;
  var inner = function () {
    return ++a;
  };
  return inner;
})();
outer(); // 1
outer = null; // 식별자의 inner 함수 참조 끊음
```

## 클로저 활용

클로저는 <u>정보은닉, 부분 적용 함수, 디바운스, 커링함수</u> 등 여러 가지로 활용될 수 있다.

- **정보 은닉**  
  <u>외부로 전달하는 변수만 접근이 가능하다</u>는 클로저의 특징을 활용  
  외부에서 접근이 가능한 public 값만 반환  
  값이 여러개일 경우 객체나 배열 형태로 반환한다.
- **디바운스**  
  짧은 시간에 동일한 이벤트가 여러 번 발생할 경우, 처음 혹은 마지막 이벤트에 대해 한 번만 처리하는 것  
  프론트엔드 성능 최적화를 위함  
  scroll, wheel, mouseMove 등 이벤트에 주로 쓰임
